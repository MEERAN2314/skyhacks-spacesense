<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpaceSense Pro - Professional Orbital Debris Intelligence</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/animations.css">
    <link rel="stylesheet" href="/static/css/advanced-components.css">
    <link rel="stylesheet" href="/static/css/advanced-features.css">
    <link rel="stylesheet" href="/static/css/responsive.css">
    <link rel="stylesheet" href="/static/css/export-modal.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" onload="console.log('✅ jsPDF loaded:', !!window.jspdf)" onerror="console.error('❌ jsPDF failed to load')"></script>
</head>
<body>
    <div class="space-background">
        <div class="stars"></div>
        <div class="twinkling"></div>
        <div class="shooting-stars"></div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-satellite"></i>
                <span>SpaceSense Pro</span>
            </div>
            
            <!-- Mobile Menu Toggle -->
            <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="nav-status">
                <div class="nav-controls">
                    <button class="refresh-btn" id="refreshData" title="Refresh Data" aria-label="Refresh data">
                        <i class="fas fa-sync-alt"></i>
                        <span>Refresh</span>
                    </button>
                    <button class="auto-refresh-btn" id="toggleAutoRefresh" title="Toggle Auto-Refresh" aria-label="Toggle auto-refresh">
                        <i class="fas fa-play"></i>
                        <span>Auto</span>
                    </button>
                </div>
                <div class="status-indicator" id="connectionStatus">
                    <i class="fas fa-circle"></i>
                    <span>Connected</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Dashboard -->
    <div class="dashboard-container">
        <!-- Header Stats -->
        <div class="stats-grid">
            <div class="stat-card stat-card-advanced animate-slide-up">
                <div class="stat-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div class="stat-content">
                    <h3 id="totalObjects">Loading...</h3>
                    <p>Total Objects</p>
                    <div class="stat-trend up">
                        <i class="fas fa-arrow-up"></i>
                        <span>+12 today</span>
                    </div>
                </div>
            </div>
            
            <div class="stat-card stat-card-advanced animate-slide-up" style="animation-delay: 0.1s">
                <div class="stat-icon high-risk">
                    <i class="fas fa-radiation"></i>
                </div>
                <div class="stat-content">
                    <h3 id="highRiskObjects">Loading...</h3>
                    <p>High Risk</p>
                    <div class="stat-trend down">
                        <i class="fas fa-arrow-down"></i>
                        <span>-3 today</span>
                    </div>
                </div>
            </div>
            
            <div class="stat-card stat-card-advanced animate-slide-up" style="animation-delay: 0.2s">
                <div class="stat-icon medium-risk">
                    <i class="fas fa-eye"></i>
                </div>
                <div class="stat-content">
                    <h3 id="mediumRiskObjects">Loading...</h3>
                    <p>Watch Zone</p>
                    <div class="stat-trend up">
                        <i class="fas fa-arrow-up"></i>
                        <span>+5 today</span>
                    </div>
                </div>
            </div>
            
            <div class="stat-card stat-card-advanced animate-slide-up" style="animation-delay: 0.3s">
                <div class="stat-icon">
                    <i class="fas fa-bell"></i>
                </div>
                <div class="stat-content">
                    <h3 id="activeAlerts">Loading...</h3>
                    <p>Active Alerts</p>
                    <div class="stat-trend down">
                        <i class="fas fa-arrow-down"></i>
                        <span>-1 today</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="main-grid">
            <!-- Earth Visualization -->
            <div class="panel earth-panel animate-fade-in">
                <div class="panel-header">
                    <h2><i class="fas fa-globe"></i> Live Orbital View</h2>
                    <div class="panel-controls">
                        <button class="btn-control" id="zoomIn" title="Zoom In">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button class="btn-control" id="zoomOut" title="Zoom Out">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button class="btn-control" id="toggleAnimation" title="Toggle Animation">
                            <i class="fas fa-pause"></i>
                        </button>
                        <button class="btn-control" id="resetView" title="Reset View">
                            <i class="fas fa-refresh"></i>
                        </button>
                    </div>
                </div>
                <div class="earth-container">
                    <div id="earthVisualization"></div>
                    <div class="legend">
                        <div class="legend-item">
                            <span class="legend-color debris"></span>
                            <span>Debris</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color satellite"></span>
                            <span>Satellites</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color high-risk"></span>
                            <span>High Risk</span>
                        </div>
                        <div class="zoom-indicator" id="zoomIndicator">
                            <i class="fas fa-search"></i>
                            <span id="zoomLevel">1.5x</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Risk Analysis -->
            <div class="panel risk-panel animate-fade-in" style="animation-delay: 0.2s">
                <div class="panel-header">
                    <h2><i class="fas fa-chart-line"></i> Risk Analysis</h2>
                </div>
                <div class="risk-content">
                    <div class="risk-zones">
                        <div class="risk-zone safe">
                            <div class="zone-header">
                                <i class="fas fa-check-circle"></i>
                                <span>Safe Zone</span>
                            </div>
                            <div class="zone-count" id="safeZoneCount">0</div>
                        </div>
                        <div class="risk-zone watch">
                            <div class="zone-header">
                                <i class="fas fa-eye"></i>
                                <span>Watch Zone</span>
                            </div>
                            <div class="zone-count" id="watchZoneCount">0</div>
                        </div>
                        <div class="risk-zone alert">
                            <div class="zone-header">
                                <i class="fas fa-exclamation-triangle"></i>
                                <span>Alert Zone</span>
                            </div>
                            <div class="zone-count" id="alertZoneCount">0</div>
                        </div>
                    </div>
                    
                    <div class="collision-probability">
                        <h3>Collision Probability</h3>
                        <div class="probability-bars">
                            <div class="prob-item">
                                <span>Next 24h</span>
                                <div class="prob-bar">
                                    <div class="prob-fill" id="prob24h"></div>
                                </div>
                                <span id="prob24hText">0%</span>
                            </div>
                            <div class="prob-item">
                                <span>Next Week</span>
                                <div class="prob-bar">
                                    <div class="prob-fill" id="probWeek"></div>
                                </div>
                                <span id="probWeekText">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Critical Conjunctions -->
            <div class="panel conjunctions-panel animate-fade-in" style="animation-delay: 0.4s">
                <div class="panel-header">
                    <h2><i class="fas fa-crosshairs"></i> Critical Conjunctions</h2>
                </div>
                <div class="conjunctions-list" id="conjunctionsList">
                    <!-- Dynamic content -->
                </div>
            </div>

            <!-- AI Insights -->
            <div class="panel ai-panel animate-fade-in" style="animation-delay: 0.6s">
                <div class="panel-header">
                    <h2><i class="fas fa-brain"></i> AI Insights</h2>
                </div>
                <div class="ai-content">
                    <div class="ai-analysis" id="aiAnalysis">
                        Loading AI analysis...
                    </div>
                    <div class="ai-predictions" id="aiPredictions">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Advanced Features Section -->
        <div class="advanced-section" style="margin-top: 2rem;">
            <div class="main-grid">
                <!-- Debris Heatmap -->
                <div class="panel heatmap-panel animate-fade-in">
                    <div class="panel-header">
                        <h2><i class="fas fa-fire"></i> Debris Density Heatmap</h2>
                    </div>
                    <div class="heatmap-container" id="debrisHeatmap"></div>
                </div>

                <!-- Event Timeline -->
                <div class="panel timeline-panel animate-fade-in" style="animation-delay: 0.2s">
                    <div class="panel-header">
                        <h2><i class="fas fa-clock"></i> Event Timeline</h2>
                    </div>
                    <div class="timeline-container" id="eventTimeline">
                        <!-- Dynamic timeline events -->
                    </div>
                </div>

                <!-- Satellite Tracker -->
                <div class="panel satellite-panel animate-fade-in" style="animation-delay: 0.4s">
                    <div class="panel-header">
                        <h2><i class="fas fa-satellite"></i> Satellite Tracker</h2>
                    </div>
                    <div class="satellite-tracker">
                        <div class="search-container">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" class="search-input" id="satelliteSearch" placeholder="Search satellites...">
                        </div>
                        <div class="filter-panel">
                            <div class="filter-group">
                                <button class="filter-btn active" data-filter="all">All</button>
                                <button class="filter-btn" data-filter="crewed">Crewed</button>
                                <button class="filter-btn" data-filter="science">Science</button>
                                <button class="filter-btn" data-filter="communication">Comm</button>
                                <button class="filter-btn" data-filter="navigation">Nav</button>
                            </div>
                        </div>
                        <div class="satellite-list" id="satelliteList">
                            <!-- Dynamic satellite list -->
                        </div>
                    </div>
                </div>

                <!-- Performance Metrics -->
                <div class="panel performance-panel animate-fade-in" style="animation-delay: 0.6s">
                    <div class="panel-header">
                        <h2><i class="fas fa-tachometer-alt"></i> System Performance</h2>
                    </div>
                    <div class="performance-metrics" id="performanceMetrics">
                        <!-- Dynamic performance metrics -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Initializing SpaceSense Pro...</p>
        </div>
    </div>

    <!-- Fullscreen Button -->
    <button class="fullscreen-btn" id="fullscreenBtn" title="Toggle Fullscreen">
        <i class="fas fa-expand"></i>
    </button>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="quick-action-btn" id="screenshotBtn" title="Take Screenshot">
            <i class="fas fa-camera"></i>
        </button>
        <button class="quick-action-btn" id="shareBtn" title="Share">
            <i class="fas fa-share-alt"></i>
        </button>
        <button class="quick-action-btn" id="helpBtn" title="Keyboard Shortcuts">
            <i class="fas fa-keyboard"></i>
        </button>
    </div>

    <!-- Keyboard Shortcuts Help -->
    <div class="shortcuts-help" id="shortcutsHelp">
        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">Keyboard Shortcuts</h3>
        <div class="shortcuts-list">
            <div class="shortcut-item">
                <span class="shortcut-key">Ctrl+R</span>
                <span>Refresh Data</span>
            </div>
            <div class="shortcut-item">
                <span class="shortcut-key">+/-</span>
                <span>Zoom In/Out</span>
            </div>
            <div class="shortcut-item">
                <span class="shortcut-key">Space</span>
                <span>Pause/Play</span>
            </div>
            <div class="shortcut-item">
                <span class="shortcut-key">F11</span>
                <span>Fullscreen</span>
            </div>
            <div class="shortcut-item">
                <span class="shortcut-key">Esc</span>
                <span>Close Modals</span>
            </div>
            <div class="shortcut-item">
                <span class="shortcut-key">?</span>
                <span>Show Help</span>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/static/js/responsive-nav.js"></script>
    <script src="/static/js/particle-effects.js"></script>
    <script src="/static/js/sound-effects.js"></script>
    <script src="/static/js/earth-visualization.js"></script>
    <script src="/static/js/websocket-client.js"></script>
    <script src="/static/js/dashboard.js"></script>
    <script src="/static/js/advanced-features.js"></script>
    <script src="/static/js/advanced-analytics.js"></script>
    <script src="/static/js/pdf-generator-enhanced.js"></script>
    <script src="/static/js/data-export-fixed.js"></script>
    
    <script>
        // Fullscreen functionality
        document.getElementById('fullscreenBtn')?.addEventListener('click', function() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                this.querySelector('i').className = 'fas fa-compress';
            } else {
                document.exitFullscreen();
                this.querySelector('i').className = 'fas fa-expand';
            }
        });
        
        // Screenshot functionality
        document.getElementById('screenshotBtn')?.addEventListener('click', function() {
            if (window.wsClient) {
                window.wsClient.showNotification('Screenshot feature coming soon!', 'info');
            }
        });
        
        // Share functionality
        document.getElementById('shareBtn')?.addEventListener('click', async function() {
            if (navigator.share) {
                try {
                    await navigator.share({
                        title: 'SpaceSense Pro',
                        text: 'Check out this amazing orbital debris tracking system!',
                        url: window.location.href
                    });
                } catch (err) {
                    console.log('Share failed:', err);
                }
            } else {
                if (window.wsClient) {
                    window.wsClient.showNotification('Share not supported on this browser', 'warning');
                }
            }
        });
        
        // Help button
        document.getElementById('helpBtn')?.addEventListener('click', function() {
            const help = document.getElementById('shortcutsHelp');
            help.classList.toggle('show');
            setTimeout(() => {
                if (help.classList.contains('show')) {
                    help.classList.remove('show');
                }
            }, 5000);
        });
        
        // Keyboard shortcut for help
        document.addEventListener('keydown', function(e) {
            if (e.key === '?' || e.key === 'h') {
                document.getElementById('helpBtn')?.click();
            }
            if (e.key === 'Escape') {
                document.getElementById('shortcutsHelp')?.classList.remove('show');
            }
        });
    </script>
</body>
</html>